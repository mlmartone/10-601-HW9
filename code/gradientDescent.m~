function data = gradientDescent(data)
gamma = .001;
convergeVal = .00005;
userChange = 1;
movieChange = 1;
%Iterate through all training examples, updating learned user preferences
while max(userChange) > convergeVal || max(movieChange) > convergeVal
    sample = round(rand*(size(data.train,1)-1))+1;
    %Get the current sample information
    user = data.train(sample,1);
    movie = data.train(sample,2);
    rating = data.train(sample,3);
    numGenres = sum(data.movieMat(movie,:)');
    error = rating - sum(data.userMat(user,:).*data.movieMat(movie,:))/...
        numGenres;
    userMatGrad = -error*data.movieMat(movie,:);
    movieMatGrad = -error*data.userMat(user,:);
    userChange = gamma*userMatGrad;
    data.userMat(user,:) = data.userMat(user,:) - userChange;
    movieChange = gamma*movieMatGrad;
    data.movieMat(movie,:) = data.movieMat(movie,:) - movieChange;
end
end